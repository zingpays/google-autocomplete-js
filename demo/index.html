<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Google AutoComplete JS - CDN Demo</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 40px 20px;
      background-color: #f5f5f5;
    }

    .demo-container {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      margin-bottom: 30px;
    }

    h1 {
      color: #333;
      text-align: center;
      margin-bottom: 40px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: #333;
    }

    .output {
      background-color: #f8f9fa;
      border: 1px solid #e9ecef;
      border-radius: 4px;
      padding: 15px;
      margin-top: 15px;
      font-family: monospace;
      white-space: pre-wrap;
      min-height: 40px;
    }

    .note {
      background-color: #e7f3ff;
      border-left: 4px solid #2196F3;
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
    }

    .warning {
      background-color: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 15px;
      margin: 20px 0;
      border-radius: 4px;
    }

    /* 自定义样式测试 */
    .custom-input {
      border: 3px solid #007bff !important;
      border-radius: 25px !important;
      padding: 15px 20px !important;
      font-size: 18px !important;
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%) !important;
      transition: all 0.3s ease !important;
    }

    .custom-input:focus {
      border-color: #28a745 !important;
      box-shadow: 0 0 20px rgba(40, 167, 69, 0.3) !important;
      background: white !important;
      transform: scale(1.02) !important;
    }

    .custom-results {
      border: 2px solid #28a745 !important;
      border-radius: 15px !important;
      box-shadow: 0 8px 32px rgba(40, 167, 69, 0.2) !important;
      background: linear-gradient(135deg, #ffffff 0%, #f8fff9 100%) !important;
    }

    .custom-wrapper {
      position: relative;
      width: 100%;
      max-width: 600px;
      margin: 0 auto;
    }

    /* 动态样式变化 */
    .success-input {
      border-color: #28a745 !important;
      background: linear-gradient(135deg, #f8fff9 0%, #d4edda 100%) !important;
    }

    .success-results {
      border-color: #28a745 !important;
      box-shadow: 0 8px 32px rgba(40, 167, 69, 0.3) !important;
    }

    /* 控制按钮样式 */
    .control-buttons {
      display: flex;
      gap: 10px;
      margin: 20px 0;
      flex-wrap: wrap;
    }

    .control-btn {
      padding: 8px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s ease;
    }

    .control-btn.primary {
      background-color: #007bff;
      color: white;
    }

    .control-btn.primary:hover {
      background-color: #0056b3;
    }

    .control-btn.success {
      background-color: #28a745;
      color: white;
    }

    .control-btn.success:hover {
      background-color: #1e7e34;
    }

    .control-btn.warning {
      background-color: #ffc107;
      color: #212529;
    }

    .control-btn.warning:hover {
      background-color: #e0a800;
    }

    .control-btn.info {
      background-color: #17a2b8;
      color: white;
    }

    .control-btn.info:hover {
      background-color: #138496;
    }
  </style>
</head>

<body>
  <h1>Google AutoComplete JS - CDN Demo</h1>

  <div class="demo-container">
    <div class="form-group">
      <label for="autocomplete-input">Search Location:</label>
      <div id="autocomplete-container"></div>
    </div>

    <div class="control-buttons">
      <button class="control-btn primary" onclick="applyCustomStyles()">应用自定义样式</button>
      <button class="control-btn success" onclick="applySuccessStyles()">应用成功样式</button>
      <button class="control-btn warning" onclick="applyWarningStyles()">应用警告样式</button>
      <button class="control-btn info" onclick="resetStyles()">重置样式</button>
      <button class="control-btn primary" onclick="updateInputStyle()">更新输入框样式</button>
      <button class="control-btn success" onclick="updateResultsStyle()">更新结果框样式</button>
      <button class="control-btn warning" onclick="toggleRemoteMode()">切换远程模式</button>
      <button class="control-btn info" onclick="showCurrentMode()">显示当前模式</button>
    </div>

    <div class="output" id="output"></div>
    
    <div class="note">
      <h3>🎨 新增功能说明</h3>
      
      <h4>📡 远程服务支持</h4>
      <p><strong>新增参数：</strong></p>
      <ul>
        <li><code>remote</code>: 是否使用远程服务，默认为false（使用Google Maps API）</li>
        <li><code>remoteUrl</code>: 远程服务地址，默认为'http://localhost:3000/places/'</li>
      </ul>
      
      <p><strong>使用方式：</strong></p>
      <ul>
        <li>设置 <code>remote: true</code> 使用自己的远程服务</li>
        <li>设置 <code>remote: false</code> 或省略该参数使用Google Maps API</li>
        <li>远程服务需要提供 <code>/autocomplete</code> 和 <code>/details</code> 接口</li>
        <li>已针对 <code>legend-places</code> 服务进行优化，支持其响应拦截器格式</li>
      </ul>
      
      <h4>🎨 样式配置功能</h4>
      <p><strong>构造函数样式选项：</strong></p>
      <ul>
        <li><code>inputClass</code>: 自定义输入框 CSS 类名</li>
        <li><code>inputStyle</code>: 自定义输入框内联样式</li>
        <li><code>resultsClass</code>: 自定义结果容器 CSS 类名</li>
        <li><code>resultsStyle</code>: 自定义结果容器内联样式</li>
        <li><code>wrapperClass</code>: 自定义包装器 CSS 类名</li>
      </ul>
      
      <p><strong>动态样式更新方法：</strong></p>
      <ul>
        <li><code>updateInputStyle(style)</code>: 更新输入框样式</li>
        <li><code>updateResultsStyle(style)</code>: 更新结果容器样式</li>
        <li><code>updateInputClass(className)</code>: 更新输入框类名</li>
        <li><code>updateResultsClass(className)</code>: 更新结果容器类名</li>
      </ul>
      
      <p><strong>测试说明：</strong> 点击上方按钮可以测试各种功能，包括样式配置、远程模式切换等。</p>
    </div>
  </div>


  <!-- Include our built component (includes Google Maps API Loader) -->
  <script src="./google-autocomplete.min.js"></script>

  <script>
    // Initialize the component using the CDN approach
    const autocomplete = googleAutoComplete(document.getElementById('autocomplete-container'), {
      apiKey: 'AIzaSyCN3Gpqy5zwW9jB6Nuz5Ozsk0nnl6R57Kk', // Replace with your actual API key
      placeholder: 'Enter any location...',
      
      // 新增remote参数配置
      remote: false, // 设置为true使用远程服务，false使用Google Maps API
      remoteUrl: 'https://feplaces.legendtrading.com/places/', // 远程服务地址
      
      // 测试新的样式配置选项
      inputClass: 'custom-input',
      inputStyle: {
        'font-weight': '500',
        'letter-spacing': '0.5px'
      },
      resultsClass: 'custom-results',
      resultsStyle: {
        'z-index': '9999',
        'max-height': '350px'
      },
      wrapperClass: 'custom-wrapper',
      
      onSelect: function (place) {
        document.getElementById('output').textContent = `Selected: ${place.formattedAddress || place.displayName || place.query}`;
        console.log('Full place object:', place);
      },
      onInput: function (value) {
        console.log('onInput', value);
        if (value.length > 2) {
          document.getElementById('output').textContent = `Typing: "${value}"`;
        } else if (value.length === 0) {
          document.getElementById('output').textContent = 'Ready... (Enter a location to see autocomplete suggestions)';
        }
      },
      onFocus: function () {
        console.log('Input focused');
      },
      onBlur: function () {
        console.log('Input blurred');
      }
    });

    // Example of programmatic control
    setTimeout(() => {
      console.log('Component initialized:', autocomplete);
      console.log('Available methods:', Object.getOwnPropertyNames(Object.getPrototypeOf(autocomplete)));
      console.log('Available style methods:', [
        'updateInputStyle',
        'updateResultsStyle', 
        'updateInputClass',
        'updateResultsClass'
      ]);
    }, 1000);

    // 测试函数：应用自定义样式
    function applyCustomStyles() {
      autocomplete.updateInputClass('custom-input');
      autocomplete.updateResultsClass('custom-results');
      autocomplete.updateInputStyle({
        'border-color': '#007bff',
        'background': 'linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%)'
      });
      autocomplete.updateResultsStyle({
        'border-color': '#28a745',
        'box-shadow': '0 8px 32px rgba(40, 167, 69, 0.2)'
      });
      document.getElementById('output').textContent = '✅ 已应用自定义样式';
    }

    // 测试函数：应用成功样式
    function applySuccessStyles() {
      autocomplete.updateInputClass('custom-input success-input');
      autocomplete.updateResultsClass('custom-results success-results');
      autocomplete.updateInputStyle({
        'border-color': '#28a745',
        'background': 'linear-gradient(135deg, #f8fff9 0%, #d4edda 100%)'
      });
      autocomplete.updateResultsStyle({
        'border-color': '#28a745',
        'box-shadow': '0 8px 32px rgba(40, 167, 69, 0.3)'
      });
      document.getElementById('output').textContent = '✅ 已应用成功样式';
    }

    // 测试函数：应用警告样式
    function applyWarningStyles() {
      autocomplete.updateInputClass('custom-input');
      autocomplete.updateResultsClass('custom-results');
      autocomplete.updateInputStyle({
        'border-color': '#ffc107',
        'background': 'linear-gradient(135deg, #fffbf0 0%, #fef3cd 100%)'
      });
      autocomplete.updateResultsStyle({
        'border-color': '#ffc107',
        'box-shadow': '0 8px 32px rgba(255, 193, 7, 0.3)'
      });
      document.getElementById('output').textContent = '⚠️ 已应用警告样式';
    }

    // 测试函数：重置样式
    function resetStyles() {
      autocomplete.updateInputClass('');
      autocomplete.updateResultsClass('');
      autocomplete.updateInputStyle({});
      autocomplete.updateResultsStyle({});
      document.getElementById('output').textContent = '🔄 样式已重置';
    }

    // 测试函数：更新输入框样式
    function updateInputStyle() {
      const randomColors = ['#007bff', '#28a745', '#ffc107', '#dc3545', '#6f42c1'];
      const randomColor = randomColors[Math.floor(Math.random() * randomColors.length)];
      
      autocomplete.updateInputStyle({
        'border-color': randomColor,
        'box-shadow': `0 0 20px ${randomColor}40`
      });
      
      document.getElementById('output').textContent = `🎨 输入框样式已更新，边框颜色: ${randomColor}`;
    }

    // 测试函数：更新结果框样式
    function updateResultsStyle() {
      const randomColors = ['#28a745', '#007bff', '#ffc107', '#dc3545', '#6f42c1'];
      const randomColor = randomColors[Math.floor(Math.random() * randomColors.length)];
      
      autocomplete.updateResultsStyle({
        'border-color': randomColor,
        'box-shadow': `0 8px 32px ${randomColor}30`
      });
      
      document.getElementById('output').textContent = `🎨 结果框样式已更新，边框颜色: ${randomColor}`;
    }

    // 测试函数：切换远程模式
    function toggleRemoteMode() {
      // 注意：这个功能需要重新创建组件实例，因为remote参数在构造函数中设置
      const currentValue = autocomplete.getValue();
      const container = document.getElementById('autocomplete-container');
      
      // 销毁当前实例
      autocomplete.destroy();
      
      // 重新创建实例，切换remote模式
      const newAutocomplete = googleAutoComplete(container, {
        apiKey: 'AIzaSyCN3Gpqy5zwW9jB6Nuz5Ozsk0nnl6R57Kk',
        placeholder: 'Enter any location...',
        remote: !autocomplete.options.remote, // 切换remote模式
        remoteUrl: 'http://localhost:3000/places/',
        inputClass: 'custom-input',
        inputStyle: {
          'font-weight': '500',
          'letter-spacing': '0.5px'
        },
        resultsClass: 'custom-results',
        resultsStyle: {
          'z-index': '9999',
          'max-height': '350px'
        },
        wrapperClass: 'custom-wrapper',
        onSelect: function (place) {
          document.getElementById('output').textContent = `Selected: ${place.formattedAddress || place.displayName || place.query}`;
          console.log('Full place object:', place);
        },
        onInput: function (value) {
          console.log('onInput', value);
          if (value.length > 2) {
            document.getElementById('output').textContent = `Typing: "${value}"`;
          } else if (value.length === 0) {
            document.getElementById('output').textContent = 'Ready... (Enter a location to see autocomplete suggestions)';
          }
        },
        onFocus: function () {
          console.log('Input focused');
        },
        onBlur: function () {
          console.log('Input blurred');
        }
      });
      
      // 恢复输入值
      if (currentValue) {
        newAutocomplete.setValue(currentValue);
      }
      
      // 更新全局变量
      window.autocomplete = newAutocomplete;
      
      const mode = newAutocomplete.options.remote ? '远程服务模式' : 'Google Maps API模式';
      document.getElementById('output').textContent = `🔄 已切换到${mode}`;
    }

    // 测试函数：显示当前模式
    function showCurrentMode() {
      const mode = autocomplete.options.remote ? '远程服务模式' : 'Google Maps API模式';
      const url = autocomplete.options.remote ? autocomplete.options.remoteUrl : 'Google Maps API';
      document.getElementById('output').textContent = `📡 当前模式: ${mode}\n服务地址: ${url}`;
    }
  </script>
</body>

</html>